import{_ as V}from"./AppLayout.vue_vue_type_script_setup_true_lang-BDv_a608.js";import{d as C,r as y,o as F,a as u,b as e,u as s,h as N,w as a,e as l,f as d,t as f,i,F as $,j as B,k as E,l as w}from"./app-BROu12nU.js";import{_ as m,a as _,b as c,c as p}from"./CardTitle.vue_vue_type_script_setup_true_lang-BKih_dnt.js";import{_ as S}from"./CardDescription.vue_vue_type_script_setup_true_lang-CjX4X73i.js";import{_ as v}from"./index-BE-gfsH9.js";import{_ as j,a as D,b as L,c as R,d as b}from"./SelectValue.vue_vue_type_script_setup_true_lang-B0jFY1N7.js";import"./index-C_7nduq-.js";import"./index-BMdsnYYQ.js";import"./VisuallyHidden-Bv5znWlI.js";import"./useForwardExpose-BNyMVrtm.js";import"./useForwardPropsEmits-DkhaOHi9.js";import"./index-BDXRdVD0.js";import"./check-CqkxZVO9.js";import"./useFormControl-CsNtCUd_.js";const T={class:"flex flex-col gap-6 p-6"},O={class:"grid gap-4 md:grid-cols-3"},P={class:"text-2xl font-bold"},Y={class:"text-2xl font-bold text-red-600"},q={class:"text-2xl font-bold text-blue-600"},z={key:0,class:"text-center py-8 text-muted-foreground"},G={key:1,class:"text-center py-8"},H={key:2,class:"space-y-3"},J={class:"flex-1 space-y-1"},K={class:"flex items-center gap-2"},Q={class:"font-semibold"},W={key:0,class:"text-xs text-muted-foreground"},X={class:"text-sm text-muted-foreground"},Z={class:"w-40"},I={class:"flex items-start gap-2"},tt={class:"flex items-start gap-2"},et={class:"flex items-start gap-2"},gt=C({__name:"UserManagement",setup(st){const U=[{title:"Admin Dashboard",href:"/admin/dashboard"},{title:"User Management",href:"/admin/users"}],r=y([]),g=y(!0),k=y(null),h=async()=>{try{g.value=!0,k.value=window.$page?.props?.auth?.user;const o=await w.get("/api/admin/users");r.value=Array.isArray(o.data)?o.data:[]}catch(o){console.error("Error fetching users:",o),r.value=[]}finally{g.value=!1}},A=async(o,t)=>{try{await w.patch(`/api/admin/users/${o}/role`,{role:t});const n=r.value.find(x=>x.id===o);n&&(n.role=t)}catch(n){alert(n.response?.data?.message||"Error updating user role"),console.error("Error updating role:",n)}},M=o=>({admin:"destructive",faculty:"secondary",student:"default"})[o]||"default";return F(()=>{h()}),(o,t)=>(i(),u($,null,[e(s(N),{title:"User Management"}),e(V,{breadcrumbs:U},{default:a(()=>[l("div",T,[t[16]||(t[16]=l("div",null,[l("h1",{class:"text-3xl font-bold"},"User Management"),l("p",{class:"text-muted-foreground"},"Manage user roles and permissions")],-1)),l("div",O,[e(s(m),null,{default:a(()=>[e(s(_),{class:"pb-2"},{default:a(()=>[e(s(c),{class:"text-sm font-medium text-muted-foreground"},{default:a(()=>[...t[0]||(t[0]=[d("Total Users",-1)])]),_:1})]),_:1}),e(s(p),null,{default:a(()=>[l("div",P,f(r.value.length),1)]),_:1})]),_:1}),e(s(m),null,{default:a(()=>[e(s(_),{class:"pb-2"},{default:a(()=>[e(s(c),{class:"text-sm font-medium text-muted-foreground"},{default:a(()=>[...t[1]||(t[1]=[d("Admins",-1)])]),_:1})]),_:1}),e(s(p),null,{default:a(()=>[l("div",Y,f(r.value.filter(n=>n.role==="admin").length),1)]),_:1})]),_:1}),e(s(m),null,{default:a(()=>[e(s(_),{class:"pb-2"},{default:a(()=>[e(s(c),{class:"text-sm font-medium text-muted-foreground"},{default:a(()=>[...t[2]||(t[2]=[d("Students",-1)])]),_:1})]),_:1}),e(s(p),null,{default:a(()=>[l("div",q,f(r.value.filter(n=>n.role==="student").length),1)]),_:1})]),_:1})]),e(s(m),null,{default:a(()=>[e(s(_),null,{default:a(()=>[e(s(c),null,{default:a(()=>[...t[3]||(t[3]=[d("All Users",-1)])]),_:1}),e(s(S),null,{default:a(()=>[...t[4]||(t[4]=[d("Manage user roles and access levels",-1)])]),_:1})]),_:1}),e(s(p),null,{default:a(()=>[g.value?(i(),u("div",z," Loading users... ")):r.value.length===0?(i(),u("div",G,[...t[5]||(t[5]=[l("p",{class:"text-muted-foreground"},"No users found",-1)])])):(i(),u("div",H,[(i(!0),u($,null,B(r.value,n=>(i(),u("div",{key:n.id,class:"flex items-center justify-between p-4 border rounded-lg"},[l("div",J,[l("div",K,[l("h4",Q,f(n.name),1),e(s(v),{variant:M(n.role)},{default:a(()=>[d(f(n.role),1)]),_:2},1032,["variant"]),k.value?.id===n.id?(i(),u("span",W," (You) ")):E("",!0)]),l("p",X,f(n.email),1)]),l("div",Z,[e(s(j),{"model-value":n.role,"onUpdate:modelValue":x=>A(n.id,x)},{default:a(()=>[e(s(D),null,{default:a(()=>[e(s(L))]),_:1}),e(s(R),null,{default:a(()=>[e(s(b),{value:"student"},{default:a(()=>[...t[6]||(t[6]=[d("Student",-1)])]),_:1}),e(s(b),{value:"faculty"},{default:a(()=>[...t[7]||(t[7]=[d("Faculty",-1)])]),_:1}),e(s(b),{value:"admin"},{default:a(()=>[...t[8]||(t[8]=[d("Admin",-1)])]),_:1})]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"])])]))),128))]))]),_:1})]),_:1}),e(s(m),null,{default:a(()=>[e(s(_),null,{default:a(()=>[e(s(c),null,{default:a(()=>[...t[9]||(t[9]=[d("Role Permissions",-1)])]),_:1})]),_:1}),e(s(p),{class:"space-y-3"},{default:a(()=>[l("div",I,[e(s(v),{variant:"destructive",class:"mt-1"},{default:a(()=>[...t[10]||(t[10]=[d("Admin",-1)])]),_:1}),t[11]||(t[11]=l("p",{class:"text-sm text-muted-foreground"}," Full access to all features. Can manage users, delete tickets, and view all data. ",-1))]),l("div",tt,[e(s(v),{variant:"secondary",class:"mt-1"},{default:a(()=>[...t[12]||(t[12]=[d("Faculty",-1)])]),_:1}),t[13]||(t[13]=l("p",{class:"text-sm text-muted-foreground"}," Can view assigned tickets, update ticket status, and manage their own tickets. ",-1))]),l("div",et,[e(s(v),{variant:"default",class:"mt-1"},{default:a(()=>[...t[14]||(t[14]=[d("Student",-1)])]),_:1}),t[15]||(t[15]=l("p",{class:"text-sm text-muted-foreground"},' Can create tickets, view their own tickets, and edit them while status is "Open". ',-1))])]),_:1})]),_:1})])]),_:1})],64))}});export{gt as default};
